import{r as l,j as t}from"./index-076d27c7.js";import{B as C,S as q,C as U,G as W,P as A,s as $,T as E}from"./Sidebar-96c9cf6b.js";import{A as p,D as V,G as O,F as Y,T as L,C as I,a as m,b as z,c as H,r as K,d as Q,e as X,f as Z,g as _,h as ee}from"./detailed-20478fb4.js";import{B as te,a as n}from"./Header-7671be75.js";const d="https://jobtrackerbackend.up.railway.app/api",v=$(L)(()=>({".MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"#000",color:"#000"}}));function ne(){const[g,h]=l.useState([]),[u,y]=l.useState(null),[a,T]=l.useState({rowId:"",jobTitle:"",dateCreated:"",priority:"",status:"",salary:"",location:"",notes:"",company:"",dateApplied:""}),[c,w]=l.useState({}),D=[{field:"jobTitle",headerName:"Job Title",width:200,editable:!0,sortable:!0,renderCell:e=>t.jsx(v,{multiline:!0,variant:"standard",fullWidth:!0,InputProps:{disableUnderline:!0},maxRows:4,disabled:!0,sx:{padding:1,color:"primary.main"},defaultValue:e.row.jobTitle,value:e.row.jobTitle}),renderEditCell:I},{field:"company",headerName:"Company",width:150,editable:!0,sortable:!0},{field:"location",headerName:"Job Location",width:150,editable:!0,sortable:!0,renderCell:e=>t.jsx(v,{multiline:!0,variant:"standard",fullWidth:!0,InputProps:{disableUnderline:!0},maxRows:4,disabled:!0,sx:{padding:1,color:"primary.main"},defaultValue:e.row.location,value:e.row.location}),renderEditCell:I},{field:"dateApplied",headerName:"Date Applied",width:100,sortable:!0},{field:"priority",headerName:"Priority",width:80,editable:!0,sortable:!0},{field:"status",headerName:"Status",width:130,type:"singleSelect",valueOptions:["Bookmarked","Applying","Applied","Interviewing","Negotiating","Accepted"],editable:!0,sortable:!0},{field:"actions",headerName:"Actions",width:200,renderCell:e=>{var o;return((o=c[e.id])==null?void 0:o.mode)===m.Edit?t.jsxs(t.Fragment,{children:[t.jsx(n,{onClick:()=>f(e.row.rowId),variant:"contained",children:"Save"}),t.jsx("pre",{children:" "}),t.jsx(n,{onClick:()=>j(e.row.rowId),variant:"contained",children:"Cancel"})]}):t.jsxs(t.Fragment,{children:[t.jsx(n,{sx:{mr:1},onClick:()=>P(e.row.rowId),variant:"contained",children:"Update"}),t.jsx("br",{}),t.jsx(n,{onClick:()=>M(e.row.rowId),variant:"contained",children:"Delete"})]})},renderEditCell:e=>(console.log("Edit Cell Params:",e),t.jsxs(t.Fragment,{children:[t.jsx(n,{onClick:()=>f(e.row.jobId),variant:"contained",children:"Save"}),t.jsx("br",{}),t.jsx(z,{onClick:()=>j(e.row.jobId),icon:t.jsx(H,{}),label:"Cancel",className:"textPrimary"})]}))}],R={height:500};l.useEffect(()=>{p.get(`${d}/applications`).then(e=>{console.log("Connected toL ",`${d}/applications`);const r=e.data.map(o=>({rowId:o.rowId,jobTitle:o.jobTitle,dateCreated:o.dateCreated,priority:o.priority,status:o.status,salary:o.salary,location:o.location,notes:o.notes,company:o.company,dateApplied:o.dateApplied}));console.log("response data: ",e.data),h(r)}).catch(e=>{console.error("Error fetching jobs: ",e)}).finally(()=>{})},[]);const J=e=>{e.preventDefault();const r=e.target.getAttribute("name"),o=e.target.value,i={...a};i[r]=o,T(i)},S=async e=>{e.preventDefault();const r={rowId:K(),jobTitle:a.jobTitle,dateCreated:a.dateCreated,priority:a.priority,status:a.status,salary:a.salary,location:a.location,notes:a.notes,company:a.company,dateApplied:a.dateApplied};try{await p.post(`${d}/api/applications`,r),h([...g,r])}catch(o){console.error("Error adding job application:",o)}},k=l.useCallback((e,r)=>new Promise((o,i)=>{y({resolve:o,reject:i,newRow:e,oldRow:r})}),[]),N=e=>{console.log(e)},b=async e=>{const{newRow:r,oldRow:o,resolve:i}=u;if(console.log("What is the new row? ",r),e==="Yes")try{const s={rowId:r.rowId,jobTitle:r.jobTitle,dateCreated:r.dateCreated,priority:r.priority,status:r.status,salary:r.salary,location:r.location,notes:r.notes,company:r.company,dateApplied:r.dateApplied};console.log("updJob is: ",s),await p.post(`${d}/applications/${r.rowId}`,s),i(r)}catch(s){console.error("Error updating Job:",s)}else e==="No"&&i(o);y(null)},F=()=>{if(!u)return null;const{newRow:e,oldRow:r,resolve:o}=u;console.log("what is row right renderConfirmDialog: ",e);const i=Q(r,e),s=Object.keys(i.updated);if(console.log("what is row right renderConfirmDialog: ",e),JSON.stringify(e)===JSON.stringify(r)){o(r),y(null);return}return t.jsxs(X,{maxWidth:"xs",open:u,children:[t.jsx(Z,{children:"Confirm Update"}),t.jsxs(_,{children:[t.jsx(E,{variant:"body1",gutterBottom:!0,children:"You are about to update the following information:"}),s.map(x=>t.jsxs("div",{style:{backgroundColor:"#f8f8f8",padding:"8px",border:"1px solid #ccc",marginBottom:"8px"},children:[t.jsxs("strong",{children:[x,":"]})," ",i.updated[x]]},x)),t.jsx(E,{variant:"body1",gutterBottom:!0,style:{marginTop:"1em"},children:"Are you sure you want to proceed?"})]}),t.jsxs(ee,{children:[t.jsx(n,{onClick:()=>b("No"),color:"primary",children:"No"}),t.jsx(n,{onClick:()=>b("Yes"),color:"primary",children:"Yes"})]})]})},B=async()=>{try{const r=(await p.get(`${d}/applications`)).data.map(o=>({rowId:o.rowId,jobTitle:o.jobTitle,dateCreated:o.dateCreated,priority:o.priority,status:o.status,salary:o.salary,location:o.location,notes:o.notes,company:o.company,dateApplied:o.dateApplied}));h(r)}catch(e){console.error("Error fetching applications:",e)}},M=async e=>{try{await p.post(`${d}/applications/${e}/delete`),await B(),alert("Application deleted!")}catch(r){console.error("Error deleting application:",r)}},P=e=>{console.log("We just setRowEdit"),w({...c,[e]:{mode:m.Edit}})},f=async e=>{console.log("We just setRowSAVE"),w({...c,[e]:{mode:m.View}})},j=e=>{w({...c,[e]:{mode:m.View,ignoreModifications:!0}})},G=[{name:"jobTitle",type:"text",required:!0,placeholder:"Enter a job name.."},{name:"dateCreated",type:"date",required:!0,placeholder:"Enter location.."},{name:"priority",type:"text",placeholder:"Enter priority.."},{name:"status",type:"text",required:!0,placeholder:"Enter status.."},{name:"salary",type:"text",required:!0,placeholder:"Enter salary.."},{name:"location",type:"text",required:!0,placeholder:"Enter location.."},{name:"notes",type:"text",required:!0,placeholder:"Enter notes.."},{name:"company",type:"text",required:!0,placeholder:"Enter a company name.."},{name:"dateApplied",type:"date",required:!0,placeholder:"Enter a date applied.."}];return t.jsxs(C,{sx:{display:"flex"},children:[t.jsx(q,{}),t.jsxs(C,{component:"main",sx:{backgroundColor:"#F5F5F5",flexGrow:1,overflow:"auto"},children:[t.jsx(te,{}),t.jsx(U,{maxWidth:"lg",sx:{mt:4,mb:4},children:t.jsx(W,{item:!0,xs:12,md:8,lg:9,children:t.jsxs(A,{sx:{p:2,display:"flex",flexDirection:"column"},children:[t.jsx("h2",{children:"Applications"}),t.jsxs(A,{sx:R,children:[F(),t.jsx(V,{columns:D,rows:g,getRowHeight:()=>"auto",getRowId:e=>e.rowId,autoPageSize:!0,editMode:"row",processRowUpdate:k,onProcessRowUpdateError:N,rowModesModel:c,slots:{toolbar:O}})]}),t.jsx("h2",{children:"Add a Job"}),t.jsx(Y,{formName:"Add Job",fields:G,onSubmit:S,onChange:J})]})})})]})]})}export{ne as default};
