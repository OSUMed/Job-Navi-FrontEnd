import{r as i,_ as v,j as t,c as $}from"./index-076d27c7.js";import{A as f,D as q,G as V,F as _,T as Y,C as O,a as C,b as J,c as L,r as H,d as K,e as X,f as z,g as Q,h as Z}from"./detailed-20478fb4.js";import{g as ee,a as te,s as U,u as oe,_ as ae,c as ne,B as I,S as re,C as se,G as le,P as j,T as R}from"./Sidebar-96c9cf6b.js";import{B as ie,a as c}from"./Header-7671be75.js";function de(m){return ee("MuiTableContainer",m)}te("MuiTableContainer",["root"]);const ce=["className","component"],me=m=>{const{classes:d}=m;return ne({root:["root"]},de,d)},pe=U("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(m,d)=>d.root})({width:"100%",overflowX:"auto"}),ue=i.forwardRef(function(d,u){const s=oe({props:d,name:"MuiTableContainer"}),{className:h,component:n="div"}=s,g=ae(s,ce),l=v({},s,{component:n}),w=me(l);return t.jsx(pe,v({ref:u,as:n,className:$(w.root,h),ownerState:l},g))}),he=ue,x="https://cors-anywhere-osu.up.railway.app/https://jobtrackerbackend.up.railway.app/api",we=U(Y)(()=>({".MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"#000",color:"#000"}}));function ye({cookie:m}){const[d,u]=i.useState([]),[s,h]=i.useState(null),[n,g]=i.useState({rowId:"",companyName:"",fullName:"",title:"",email:"",phone:"",relationship:"",notes:"",followUpDate:""}),[l,w]=i.useState({}),T=[{field:"companyName",headerName:"Company Name",width:150,editable:!1,sortable:!0},{field:"fullName",headerName:"Full Name",width:150,editable:!0,sortable:!0},{field:"email",headerName:"Email",width:190,editable:!0,sortable:!0},{field:"notes",headerName:"Notes",width:320,editable:!0,sortable:!0,renderCell:e=>t.jsx(we,{multiline:!0,variant:"standard",fullWidth:!0,InputProps:{disableUnderline:!0},maxRows:4,disabled:!0,sx:{padding:1,color:"primary.main"},defaultValue:e.row.notes,value:e.row.notes}),renderEditCell:O},{field:"followUpDate",headerName:"Follow Up",width:100,sortable:!0},{field:"actions",headerName:"Actions",width:200,renderCell:e=>{var o;return((o=l[e.id])==null?void 0:o.mode)===C.Edit?(console.log("IneditMode outside setRowSave call: ",e),t.jsxs(t.Fragment,{children:[t.jsx(c,{onClick:()=>D(e.row.rowId),variant:"contained",children:"Save"}),t.jsx("pre",{children:" "}),t.jsx(c,{onClick:()=>E(e.row.rowId),variant:"contained",children:"Cancel"})]})):t.jsxs(t.Fragment,{children:[t.jsx(c,{sx:{mr:1},onClick:()=>P(e.row.rowId),variant:"contained",children:"Update"}),t.jsx("br",{}),t.jsx(c,{onClick:()=>G(e.row.rowId),variant:"contained",children:"Delete"})]})},renderEditCell:e=>t.jsxs(t.Fragment,{children:[t.jsx(c,{onClick:()=>D(e.row.contactId),variant:"contained",children:"Save"}),t.jsx("br",{}),t.jsx(J,{onClick:()=>E(e.row.contactId),icon:t.jsx(L,{}),label:"Cancel",className:"textPrimary"})]})}],S={height:500};i.useEffect(()=>{f.get(`${x}/contacts`).then(e=>{const a=e.data.map(o=>({rowId:o.rowId,companyName:o.companyName,fullName:o.fullName,title:o.title,email:o.email,phone:o.phone,relationship:o.relationship,notes:o.notes,followUpDate:o.followUpDate}));console.log("response data is: ",e.data),u(a)}).catch(e=>{console.error("Error fetching contacts: ",e)}).finally(()=>{})},[]);const F=e=>{e.preventDefault();const a=e.target.getAttribute("name"),o=e.target.value,r={...n};r[a]=o,g(r)},M=async e=>{e.preventDefault();const a={contactId:H(),companyName:n.companyName,fullName:n.fullName,title:n.title,email:n.email,phone:n.phone,relationship:n.relationship,notes:n.notes,followUpDate:n.followUpDate};try{await f.post(`${x}/contacts`,a),await N()}catch(o){console.error("Error adding contact:",o)}},A=i.useCallback((e,a)=>new Promise((o,r)=>{h({resolve:o,reject:r,newRow:e,oldRow:a})}),[]),k=e=>{console.log(e)},b=async e=>{const{newRow:a,oldRow:o,resolve:r}=s;if(console.log("What is the new row? ",a),e==="Yes")try{const p={rowId:a.rowId,companyName:a.companyName,fullName:a.fullName,title:a.title,email:a.email,phone:a.phone,relationship:a.relationship,notes:a.notes,followUpDate:a.followUpDate};console.log("UpdContact is: ",p),await f.post(`${x}/contacts/${a.rowId}`,p),r(a)}catch(p){console.error("Error updating contact:",p)}else e==="No"&&r(o);h(null)},B=()=>{if(!s)return null;const{newRow:e,oldRow:a,resolve:o}=s;console.log("what is row right renderConfirmDialog: ",e);const r=K(a,e),p=Object.keys(r.updated);if(JSON.stringify(e)===JSON.stringify(a)){o(a),h(null);return}return t.jsxs(X,{maxWidth:"xs",open:s,children:[t.jsx(z,{children:"Confirm Update"}),t.jsxs(Q,{children:[t.jsx(R,{variant:"body1",gutterBottom:!0,children:"You are about to update the following information:"}),p.map(y=>t.jsxs("div",{style:{backgroundColor:"#f8f8f8",padding:"8px",border:"1px solid #ccc",marginBottom:"8px"},children:[t.jsxs("strong",{children:[y,":"]})," ",r.updated[y]]},y)),t.jsx(R,{variant:"body1",gutterBottom:!0,style:{marginTop:"1em"},children:"Are you sure you want to proceed?"})]}),t.jsxs(Z,{children:[t.jsx(c,{onClick:()=>b("No"),color:"primary",children:"No"}),t.jsx(c,{onClick:()=>b("Yes"),color:"primary",children:"Yes"})]})]})},N=async()=>{try{const a=(await f.get(`${x}/contacts`)).data.map(o=>({rowId:o.rowId,companyName:o.companyName,fullName:o.fullName,title:o.title,email:o.email,phone:o.phone,relationship:o.relationship,notes:o.notes,followUpDate:o.followUpDate}));u(a)}catch(e){console.error("Error fetching contacts:",e)}},G=async e=>{try{await f.post(`${x}/contacts/${e}/delete`),await N(),alert("Contact deleted!")}catch(a){console.error("Error deleting contact:",a)}},P=e=>{console.log("We just setRowEdit"),w({...l,[e]:{mode:C.Edit}})},D=async e=>{console.log("We just setRowSAVE"),w({...l,[e]:{mode:C.View}})},E=e=>{w({...l,[e]:{mode:C.View,ignoreModifications:!0}})},W=[{name:"companyName",type:"text",required:!0,placeholder:"Enter company name.."},{name:"fullName",type:"date",required:!0,placeholder:"Enter full name.."},{name:"title",type:"text",placeholder:"Enter title.."},{name:"email",type:"text",required:!0,placeholder:"Enter email.."},{name:"phone",type:"text",required:!0,placeholder:"Enter phone.."},{name:"relationship",type:"text",required:!0,placeholder:"Enter relationship.."},{name:"notes",type:"text",required:!0,placeholder:"Enter notes.."},{name:"followUpDate",type:"date",required:!0,placeholder:"Enter follow-up date.."}];return t.jsxs(I,{sx:{display:"flex"},children:[t.jsx(re,{}),t.jsxs(I,{component:"main",sx:{backgroundColor:"#F5F5F5",flexGrow:1,overflow:"auto"},children:[t.jsx(ie,{}),t.jsx(se,{maxWidth:"lg",sx:{mt:4,mb:4},children:t.jsx(le,{item:!0,xs:12,md:8,lg:9,children:t.jsx(j,{sx:{p:2,display:"flex",flexDirection:"column"},children:t.jsxs(i.Fragment,{children:[t.jsx("h2",{children:"Contacts"}),t.jsxs(he,{component:j,children:[t.jsxs(j,{sx:S,children:[B(),t.jsx(q,{columns:T,rows:d,getRowHeight:()=>"auto",getRowId:e=>e.rowId,editMode:"row",processRowUpdate:A,onProcessRowUpdateError:k,rowModesModel:l,slots:{toolbar:V}})]}),t.jsx("h2",{children:"Add a Contact"}),t.jsx(_,{formName:"Add Contact",fields:W,onSubmit:M,onChange:F})]})]})})})})]})]})}export{ye as default};
